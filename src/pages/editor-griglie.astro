---
import Layout from '../layouts/Layout.astro';
import HeaderFixed from '../components/HeaderFixed.astro';
---

<Layout>
  <HeaderFixed />
  
  <main class="editor-page">
    <div class="editor-layout">
      <aside class="controls-panel">
        <div class="panel-header">
          <h2>GRIGLIE</h2>
          <p class="panel-subtitle">Pattern geometrici programmati</p>
        </div>

        <div class="control-group">
          <label for="seed">Seed</label>
          <input type="number" id="seed" value="12345" min="1" max="999999">
        </div>

        <div class="control-group">
          <label for="gridSize">Dimensione griglia</label>
          <input type="range" id="gridSize" min="5" max="30" value="12" step="1">
          <span class="value-display" id="gridSizeValue">12</span>
        </div>

        <div class="control-group">
          <label for="gridSize">Zoom (dettaglio)</label>
          <input type="range" id="gridSize" min="1" max="150" value="1" step="1">
          <span class="value-display" id="gridSizeValue">1</span>
        </div>

        <div class="control-group">
          <label for="rotationSpeed">Velocità rotazione</label>
          <input type="range" id="rotationSpeed" min="0" max="5" value="1" step="0.1">
          <span class="value-display" id="rotationSpeedValue">1</span>
        </div>

        <div class="control-group">
          <label for="rotationDirection">Direzione</label>
          <select id="rotationDirection">
            <option value="1">Orario</option>
            <option value="-1">Antiorario</option>
            <option value="0">Statico</option>
          </select>
        </div>

        <div class="control-group">
          <label for="bgColor">Colore sfondo</label>
          <select id="bgColor">
            <option value="black">Nero</option>
            <option value="white">Bianco</option>
          </select>
        </div>

        <div class="control-group">
          <label for="lineColor">Colore linee</label>
          <select id="lineColor">
            <option value="black">Nero</option>
            <option value="white" selected>Bianco</option>
            <option value="color">Colore</option>
          </select>
        </div>

        <div class="control-group">
          <label for="hue">Tonalità</label>
          <input type="range" id="hue" min="0" max="360" value="200" step="1">
          <span class="value-display" id="hueValue">200</span>
        </div>

        <div class="control-group">
          <label for="lineSpacing">Spaziatura linee</label>
          <input type="range" id="lineSpacing" min="5" max="50" value="15" step="1">
          <span class="value-display" id="lineSpacingValue">15</span>
        </div>

        <div class="control-group">
          <label for="layerCount">Numero layer</label>
          <input type="range" id="layerCount" min="2" max="8" value="4" step="1">
          <span class="value-display" id="layerCountValue">4</span>
        </div>

        <div class="control-group">
          <label for="layerRotation">Rotazione layer (°)</label>
          <input type="range" id="layerRotation" min="0" max="180" value="45" step="1">
          <span class="value-display" id="layerRotationValue">45</span>
        </div>

        <div class="button-group">
          <button id="regenerate" class="btn-primary">Rigenera</button>
          <button id="downloadPNG" class="btn-secondary">Scarica PNG</button>
          <button id="downloadGIF" class="btn-secondary">Scarica GIF (5s)</button>
        </div>

        <a href="/editor" class="back-link">← Torna ai generatori</a>
      </aside>

      <section class="canvas-section">
        <div id="canvasContainer" class="canvas-container"></div>
        <div class="canvas-info">
          <span>1000 × 1500 px (2:3)</span>
        </div>
      </section>
    </div>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js" is:inline></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js" is:inline></script>
  <script src="/js/griglieEditor.js" is:inline></script>
</Layout>

<style>
  .editor-page {
    min-height: 100vh;
    background: #000;
    color: #fff;
    padding-top: 120px;
  }

  .editor-layout {
    display: grid;
    grid-template-columns: 320px 1fr;
    min-height: calc(100vh - 120px);
  }

  .controls-panel {
    background: rgba(255, 255, 255, 0.02);
    border-right: 1px solid rgba(255, 255, 255, 0.1);
    padding: 32px 24px;
    overflow-y: auto;
    max-height: calc(100vh - 120px);
  }

  .panel-header {
    margin-bottom: 32px;
    padding-bottom: 24px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .panel-header h2 {
    font-size: 1.2rem;
    font-weight: 400;
    letter-spacing: 2px;
    margin-bottom: 8px;
    font-family: 'VG5000', monospace;
  }

  .panel-subtitle {
    font-size: 12px;
    color: #666;
    letter-spacing: 1px;
    font-family: 'Basier Square Mono', monospace;
  }

  .control-group {
    margin-bottom: 24px;
  }

  .control-group label {
    display: block;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #888;
    margin-bottom: 8px;
    font-family: 'Basier Square Mono', monospace;
  }

  .control-group input[type="range"] {
    width: 100%;
    height: 4px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    -webkit-appearance: none;
    appearance: none;
    cursor: pointer;
  }

  .control-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: #fff;
    border-radius: 50%;
    cursor: pointer;
  }

  .control-group input[type="number"] {
    width: 100%;
    padding: 10px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    color: #fff;
    font-size: 14px;
    font-family: 'Basier Square Mono', monospace;
  }

  .control-group select {
    width: 100%;
    padding: 10px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    color: #fff;
    font-size: 14px;
    font-family: 'Basier Square Mono', monospace;
    cursor: pointer;
  }

  .control-group select option {
    background: #111;
  }

  .value-display {
    display: block;
    margin-top: 8px;
    font-size: 13px;
    color: #fff;
    font-family: 'Basier Square Mono', monospace;
  }

  .button-group {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 32px;
    padding-top: 24px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
  }

  .btn-primary,
  .btn-secondary {
    padding: 14px 20px;
    border: none;
    border-radius: 4px;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Basier Square Mono', monospace;
  }

  .btn-primary {
    background: #fff;
    color: #000;
  }

  .btn-primary:hover {
    background: #ddd;
  }

  .btn-secondary {
    background: transparent;
    color: #fff;
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  .btn-secondary:hover {
    border-color: #fff;
  }

  .back-link {
    display: block;
    margin-top: 24px;
    color: #666;
    text-decoration: none;
    font-size: 13px;
    transition: color 0.3s ease;
    font-family: 'Basier Square Mono', monospace;
  }

  .back-link:hover {
    color: #fff;
  }

  .canvas-section {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
    background: #0a0a0a;
    position: relative;
  }

  .canvas-container {
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .canvas-info {
    position: absolute;
    bottom: 20px;
    right: 20px;
    font-size: 11px;
    color: #666;
    font-family: 'Basier Square Mono', monospace;
  }

  @media (max-width: 900px) {
    .editor-layout {
      grid-template-columns: 1fr;
    }

    .controls-panel {
      border-right: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      max-height: none;
    }

    .canvas-section {
      min-height: 60vh;
    }
  }
</style>
