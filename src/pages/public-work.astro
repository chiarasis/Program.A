---
import Layout from '../layouts/Layout.astro';
import HeaderFixed from '../components/HeaderFixed.astro';
---

<Layout>
  <div slot="head">
  </div>

  <HeaderFixed currentPage="public-work" />

  <main class="infinite-gallery">
    <div class="gallery-ui">
      
      <div class="ui-controls">
        <button id="resetView" class="control-btn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M10 4V1L6 5L10 9V6C12.76 6 15 8.24 15 11C15 11.65 14.87 12.26 14.64 12.83L15.96 14.15C16.63 13.21 17 12.15 17 11C17 7.13 13.87 4 10 4Z" fill="currentColor"/>
            <path d="M10 16C7.24 16 5 13.76 5 11C5 10.35 5.13 9.74 5.36 9.17L4.04 7.85C3.37 8.79 3 9.85 3 11C3 14.87 6.13 18 10 18V21L14 17L10 13V16Z" fill="currentColor"/>
          </svg>
          <span>Reset</span>
        </button>
        
        <button id="zoomIn" class="control-btn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        
        <button id="zoomOut" class="control-btn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div class="ui-info">
        <span id="posterCount">0 generazioni</span>
        <span id="position">X: 0, Y: 0</span>
      </div>
    </div>

    <div id="canvas" class="gallery-canvas">
      <div id="postersContainer" class="posters-container">
        <!-- Posters will be loaded dynamically from IndexedDB -->
      </div>
    </div>

    <div class="empty-gallery" id="emptyGallery" style="display: none;">
      <div class="empty-content">
        <svg width="80" height="80" viewBox="0 0 80 80" fill="none" style="margin-bottom: 24px; opacity: 0.3;">
          <rect x="10" y="10" width="60" height="60" stroke="currentColor" stroke-width="2" fill="none"/>
          <path d="M25 40L35 30L45 40L55 30" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <a href="/editor" style="display: inline-block; padding: 12px 24px; background: #fff; color: #000; text-decoration: none; border-radius: 4px; font-family: 'Basier Square Mono', monospace; font-size: 14px;">Vai ai Generatori</a>
      </div>
    </div>

    <div class="navigation-hint">
      <p>Trackpad: scorri per muoverti • Mouse: click e trascina • Doppio click per vista d'insieme</p>
    </div>
  </main>
</Layout>

<style is:global>
  @import '../assets/public-work.css';
</style>

<script src="/js/posterStorage.js" is:inline></script>
<script src="/js/infiniteGallery.js" is:inline></script>
